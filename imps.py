#!/usr/bin/python
#  -*- coding: utf-8 -*-
# Made by IMPS

from urlparse import urlparse
import requests, sys, re

VERSION = "0.0.1"

if len(sys.argv)>1:
	print "\n\t\033[1m\033[91m*****************************************************************"
	print "\t*								*"
	print "\t*			WPExploit "+VERSION+"				*"
	print "\t*			Sponsored by IMPS			*"
	print "\t*								*"	
	print "\t*****************************************************************"
	print "\tlegal disclaimer:\033[1m Usage of wpexploit for attacking targets without prior mutual consent is illegal."
	print "\tIt is the end user's responsibility to obey all applicable local, state and federal laws."
	print "\tDevelopers assume no liability and are not responsible for any misuse or damage caused by this program\033[0m\n"
	
	PARSED			= urlparse(sys.argv[1])
	URL				= PARSED.geturl()
	PORT			= PARSED.port if PARSED.port else 80

	try:
		r = requests.head(URL)
		if r.status_code==200 or 302:
			version	= requests.get(URL+"/readme.html")
			print str("\t\033[1m\033[91mWordpress version: ")+str(".".join(re.findall(r'\b\d+\b', version.text.split("logo.png")[1].split("</h1>")[0])))+str("\033[0m")
			home	= requests.get(URL)
			
	except requests.ConnectionError:
		print "\t\033[1m\033[91mhost "+URL+" does not exist\033[0m\n"

else:
	print "\nUsage: \n\t# python "+sys.argv[0]
